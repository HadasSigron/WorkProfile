<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>People Webpage</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />

  {# עדיף להשתמש ב-url_for כדי לשרת קבצים סטטיים בפלסק #}
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
</head>

<body>
  <script>const backend = "{{ backend }}";</script>

  <div id="dbDiv">
    <h3>
      DB Host:
      <span class="{% if db_host %}text-success{% else %}text-danger{% endif %}">
        {{ db_host }}
      </span>
    </h3>
  </div>

  <!-- Modal: Add Person -->
  <div id="personModal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeModal()">&times;</span>
      <h2>Add New Person</h2>

      <!-- חשוב: method/action + name לכל שדה -->
      <form id="addPersonForm" method="post" action="/add">
        <input type="text" id="firstName" name="firstName" placeholder="First Name" required /><br />
        <input type="text" id="lastName"  name="lastName"  placeholder="Last Name"  required /><br />
        <input type="number" id="age"      name="age"       placeholder="Age"       required /><br />
        <input type="text" id="workplace"  name="workplace" placeholder="Workplace" required /><br />
        <input type="text" id="address"    name="address"   placeholder="Address"   required /><br />
        <button type="submit">Add Person</button>
      </form>
    </div>
  </div>

  <div id="tableContainer">
    <div class="buttonDiv">
      {% if db_host %}
        <button class="button" onclick="handleClick()">Add Person</button>
      {% else %}
        <button class="button" disabled>Add Person</button>
      {% endif %}
    </div>

    {# רינדור אנשים, 3 בכרטיסיה (container) כמו שהיה אצלך #}
    {% for person in data %}
      {% if loop.index0 % 3 == 0 %}
      <div class="container">
      {% endif %}

        <div class="{% if db_host %}person{% else %}person-disabled{% endif %}"
             onclick="handlePersonClick(this, {{ person.id }})">
          <h3>{{ person.first_name }} {{ person.last_name }}</h3>
          <p>Age: {{ person.age }}</p>
          <p>Address: {{ person.address }}</p>
          <p>Workplace: {{ person.workplace }}</p>
        </div>

      {% if loop.index % 3 == 0 or loop.last %}
      </div>
      {% endif %}
    {% endfor %}
  </div>

  <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
</html>

